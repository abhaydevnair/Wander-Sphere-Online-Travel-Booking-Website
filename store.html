<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stored Bookings</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

  <div class="container my-5">
    <div class="card shadow-lg p-4 mx-auto" style="max-width: 900px;">
      <h2 class="text-center mb-4 text-success fw-bold">All Stored Bookings</h2>
      <table class="table table-bordered table-striped">
        <thead class="table-dark">
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Destination</th>
            <th>Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="bookingTable"></tbody>
      </table>
    </div>
  </div>

  <script>
    // Get latest booking
    const customer = JSON.parse(localStorage.getItem("customerDetails"));
    let storedBookings = JSON.parse(localStorage.getItem("allBookings")) || [];

    // âœ… Only save booking if saveBooking flag is true
    if (localStorage.getItem("saveBooking") === "true" && customer) {
      storedBookings.push(customer);
      localStorage.setItem("allBookings", JSON.stringify(storedBookings));
      localStorage.removeItem("saveBooking"); // clear flag
    }

    // Render table
    function renderTable() {
      const tableBody = document.getElementById("bookingTable");
      tableBody.innerHTML = storedBookings.length
        ? storedBookings.map((c, index) => `
          <tr>
            <td>${c.name}</td>
            <td>${c.email}</td>
            <td>${c.phone}</td>
            <td>${c.destination}</td>
            <td>${c.date}</td>
            <td>
              <button class="btn btn-danger btn-sm" onclick="deleteBooking(${index})">
                Delete
              </button>
            </td>
          </tr>
        `).join("")
        : `<tr><td colspan="6" class="text-center text-muted">No bookings saved yet.</td></tr>`;
    }

    // Delete booking by index
    function deleteBooking(index) {
      storedBookings.splice(index, 1);
      localStorage.setItem("allBookings", JSON.stringify(storedBookings));
      renderTable();
    }

    renderTable();
  </script>

</body>
</html>
